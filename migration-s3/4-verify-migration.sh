#!/bin/bash

# –°–∫—Ä–∏–ø—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏ –º–∏–≥—Ä–∞—Ü–∏–∏ –Ω–∞ S3
# –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, —Ä–∞–±–æ—Ç—É —Å–∞–π—Ç–∞ –∏ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å —Å—Å—ã–ª–æ–∫

set -e  # –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∏ –æ—à–∏–±–∫–µ

# –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
source "$(dirname "$0")/config.sh"

log "–ù–∞—á–∞–ª–æ –ø—Ä–æ–≤–µ—Ä–∫–∏ –º–∏–≥—Ä–∞—Ü–∏–∏ –Ω–∞ S3..."

# –°—á–µ—Ç—á–∏–∫–∏ –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
total_checks=0
successful_checks=0
failed_checks=0
warnings=0

# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ URL
check_url() {
    local url="$1"
    local description="$2"
    
    total_checks=$((total_checks + 1))
    
    if curl -s -I "$url" | grep -q "200 OK"; then
        successful_checks=$((successful_checks + 1))
        log "‚úì $description: $url"
        return 0
    else
        failed_checks=$((failed_checks + 1))
        error_log "‚úó $description: $url"
        return 1
    fi
}

# 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ S3 bucket
log "1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ S3 bucket..."
if aws s3 ls "s3://$S3_BUCKET/images/" &> /dev/null; then
    log "‚úì S3 bucket –¥–æ—Å—Ç—É–ø–µ–Ω"
else
    error_log "‚úó S3 bucket –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω"
    exit 1
fi

# 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–ª—É—á–∞–π–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏–∑ S3
log "2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ S3..."

# –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏–∑ S3
s3_images=$(aws s3 ls "s3://$S3_BUCKET/images/" --recursive | grep -E "\.(jpg|jpeg|png|gif|webp)$" | awk '{print $4}' | head -10)

if [ -z "$s3_images" ]; then
    error_log "–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω—ã –≤ S3"
    exit 1
fi

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–ª—É—á–∞–π–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
echo "$s3_images" | while read -r s3_key; do
    if [ -n "$s3_key" ]; then
        image_url="$S3_BASE_URL/$s3_key"
        check_url "$image_url" "–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ S3"
    fi
done

# 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
log "3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤..."
special_files=(
    "images/favicon.ico"
    "images/DESKTOP_NEW_1.jpg"
    "images/bg-winter.jpg"
    "images/bg-spring.jpg"
    "images/bg-summer.jpg"
    "images/bg-autumn.jpg"
)

for file in "${special_files[@]}"; do
    special_url="$S3_BASE_URL/$file"
    check_url "$special_url" "–°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —Ñ–∞–π–ª" || warnings=$((warnings + 1))
done

# 4. –ê–Ω–∞–ª–∏–∑ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ —Å—Ç–∞—Ä—ã—Ö —Å—Å—ã–ª–æ–∫
log "4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ —Å—Ç–∞—Ä—ã—Ö —Å—Å—ã–ª–æ–∫..."

old_links_count=0
if [ -d "$CONTENT_DIR" ]; then
    # –ü–æ–∏—Å–∫ —Å—Å—ã–ª–æ–∫, –Ω–∞—á–∏–Ω–∞—é—â–∏—Ö—Å—è —Å /images/ (—Å—Ç–∞—Ä—ã–µ –ª–æ–∫–∞–ª—å–Ω—ã–µ —Å—Å—ã–ª–∫–∏)
    old_links=$(grep -r "images/" "$CONTENT_DIR" | grep -v "$S3_BASE_URL" | grep -E "\.(jpg|jpeg|png|gif|webp)" || true)
    
    if [ -n "$old_links" ]; then
        old_links_count=$(echo "$old_links" | wc -l)
        warnings=$((warnings + old_links_count))
        error_log "–ù–∞–π–¥–µ–Ω–æ $old_links_count —Å—Ç–∞—Ä—ã—Ö —Å—Å—ã–ª–æ–∫ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:"
        echo "$old_links" | head -5 | while read -r link; do
            error_log "  $link"
        done
    else
        log "‚úì –°—Ç–∞—Ä—ã–µ —Å—Å—ã–ª–∫–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã"
    fi
fi

# 5. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞ Hugo
log "5. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞ Hugo..."
if command -v hugo &> /dev/null; then
    hugo_output=$(hugo --verbose --printPathWarnings 2>&1 || true)
    
    if echo "$hugo_output" | grep -qi "error"; then
        error_log "Hugo —Å–æ–æ–±—â–∞–µ—Ç –æ–± –æ—à–∏–±–∫–∞—Ö:"
        echo "$hugo_output" | grep -i "error" | head -3
        warnings=$((warnings + 1))
    else
        log "‚úì Hugo —Å–∏–Ω—Ç–∞–∫—Å–∏—Å –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω"
    fi
else
    log "‚ö† Hugo –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω, –ø—Ä–æ–ø—É—Å–∫ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞"
    warnings=$((warnings + 1))
fi

# 6. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
log "6. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è..."
repo_size_mb=$(du -sm . | cut -f1)
if [ "$repo_size_mb" -lt 1000 ]; then
    log "‚úì –†–∞–∑–º–µ—Ä —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è: ${repo_size_mb}MB (—Ö–æ—Ä–æ—à–æ)"
else
    error_log "‚ö† –†–∞–∑–º–µ—Ä —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è: ${repo_size_mb}MB (–≤—Å–µ –µ—â–µ –±–æ–ª—å—à–æ–π)"
    warnings=$((warnings + 1))
fi

# 7. –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
log "7. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –¥—É–±–ª–∏–∫–∞—Ç—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π..."
if [ -d "./public/images" ] || [ -d "./static/images" ]; then
    error_log "‚ö† –õ–æ–∫–∞–ª—å–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤—Å–µ –µ—â–µ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç"
    error_log "  –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —É–¥–∞–ª–∏—Ç—å –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏:"
    error_log "  - ./public/images"
    error_log "  - ./static/images"
    warnings=$((warnings + 1))
else
    log "‚úì –õ–æ–∫–∞–ª—å–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —É–¥–∞–ª–µ–Ω—ã"
fi

# 8. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –ø–æ–º–æ—â—å—é Hugo server (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
log "8. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ Hugo..."
if command -v hugo &> /dev/null; then
    # –ó–∞–ø—É—Å–∫ Hugo —Å–µ—Ä–≤–µ—Ä–∞ –≤ —Ñ–æ–Ω–µ –Ω–∞ –∫–æ—Ä–æ—Ç–∫–æ–µ –≤—Ä–µ–º—è
    hugo server --bind 127.0.0.1 --port 1313 --disableFastRender &
    hugo_pid=$!
    
    # –ñ–¥–µ–º –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞
    sleep 5
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    if curl -s "http://localhost:1313/" > /dev/null; then
        log "‚úì –õ–æ–∫–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä Hugo —Ä–∞–±–æ—Ç–∞–µ—Ç"
    else
        error_log "‚úó –õ–æ–∫–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä Hugo –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω"
        warnings=$((warnings + 1))
    fi
    
    # –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞
    kill $hugo_pid 2>/dev/null || true
    wait $hugo_pid 2>/dev/null || true
else
    log "‚ö† Hugo –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω, –ø—Ä–æ–ø—É—Å–∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–µ—Ä–≤–µ—Ä–∞"
fi

# 9. –°–æ–∑–¥–∞–Ω–∏–µ –æ—Ç—á–µ—Ç–∞
log "9. –°–æ–∑–¥–∞–Ω–∏–µ –æ—Ç—á–µ—Ç–∞..."
report_file="./migration-s3/migration-verification-report.md"

{
    echo "# –û—Ç—á–µ—Ç –æ –ø—Ä–æ–≤–µ—Ä–∫–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –Ω–∞ S3"
    echo ""
    echo "**–î–∞—Ç–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏:** $(date)"
    echo "**S3 Bucket:** $S3_BUCKET"
    echo "**CDN URL:** $S3_BASE_URL"
    echo ""
    echo "## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–≤–µ—Ä–∫–∏"
    echo ""
    echo "- ‚úÖ **–£—Å–ø–µ—à–Ω—ã—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫:** $successful_checks"
    echo "- ‚ùå **–ù–µ—É–¥–∞—á–Ω—ã—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫:** $failed_checks"
    echo "- ‚ö†Ô∏è **–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π:** $warnings"
    echo "- üìä **–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–≤–µ—Ä–æ–∫:** $total_checks"
    echo ""
    
    if [ $failed_checks -eq 0 ] && [ $warnings -eq 0 ]; then
        echo "## ‚úÖ –°—Ç–∞—Ç—É—Å: –£–°–ü–ï–®–ù–û"
        echo ""
        echo "–ú–∏–≥—Ä–∞—Ü–∏—è –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ! –í—Å–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–Ω—ã —á–µ—Ä–µ–∑ S3."
    elif [ $failed_checks -eq 0 ] && [ $warnings -gt 0 ]; then
        echo "## ‚ö†Ô∏è –°—Ç–∞—Ç—É—Å: –£–°–ü–ï–®–ù–û –° –ü–†–ï–î–£–ü–†–ï–ñ–î–ï–ù–ò–Ø–ú–ò"
        echo ""
        echo "–ú–∏–≥—Ä–∞—Ü–∏—è –ø—Ä–æ—à–ª–∞ –≤ —Ü–µ–ª–æ–º —É—Å–ø–µ—à–Ω–æ, –Ω–æ –µ—Å—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ —Å—Ç–æ–∏—Ç —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å."
    else
        echo "## ‚ùå –°—Ç–∞—Ç—É—Å: –¢–†–ï–ë–£–ï–¢–°–Ø –í–ù–ò–ú–ê–ù–ò–ï"
        echo ""
        echo "–û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã, –∫–æ—Ç–æ—Ä—ã–µ —Ç—Ä–µ–±—É—é—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è."
    fi
    
    echo ""
    echo "## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏"
    echo ""
    
    if [ -d "./public/images" ] || [ -d "./static/images" ]; then
        echo "1. **–£–¥–∞–ª–∏—Ç–µ –ª–æ–∫–∞–ª—å–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è** –ø–æ—Å–ª–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã:"
        echo "   \`\`\`bash"
        echo "   rm -rf ./public/images"
        echo "   rm -rf ./static/images"
        echo "   \`\`\`"
        echo ""
    fi
    
    echo "2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ CloudFront CDN** –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏"
    echo "3. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π"
    echo "4. **–†–µ–≥—É–ª—è—Ä–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ** —Ä–∞–±–æ—Ç—É —Å—Å—ã–ª–æ–∫"
    echo ""
    echo "## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏"
    echo ""
    echo "1. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ —Å–∞–π—Ç –≤ –±—Ä–∞—É–∑–µ—Ä–µ"
    echo "2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç—É –≥–∞–ª–µ—Ä–µ–π –∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π"
    echo "3. –£–±–µ–¥–∏—Ç–µ—Å—å –≤ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö"
    echo "4. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ \`add-new-photos.sh\` –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π"
    echo ""
    echo "---"
    echo "*–û—Ç—á–µ—Ç —Å–æ–∑–¥–∞–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫—Ä–∏–ø—Ç–æ–º 4-verify-migration.sh*"
    
} > "$report_file"

# 10. –§–∏–Ω–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
log "–ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∏–≥—Ä–∞—Ü–∏–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!"
log "–û—Ç—á–µ—Ç —Å–æ–∑–¥–∞–Ω: $report_file"
log ""
log "=== –ò–¢–û–ì–û–í–ê–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ê ==="
log "–£—Å–ø–µ—à–Ω—ã—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫: $successful_checks"
log "–ù–µ—É–¥–∞—á–Ω—ã—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫: $failed_checks"
log "–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π: $warnings"
log "–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–≤–µ—Ä–æ–∫: $total_checks"
log ""

if [ $failed_checks -eq 0 ] && [ $warnings -eq 0 ]; then
    log "üéâ –ú–ò–ì–†–ê–¶–ò–Ø –£–°–ü–ï–®–ù–ê! –í—Å–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ä–∞–±–æ—Ç–∞—é—Ç —á–µ—Ä–µ–∑ S3."
    log "–¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å add-new-photos.sh –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π."
elif [ $failed_checks -eq 0 ]; then
    log "‚úÖ –ú–ò–ì–†–ê–¶–ò–Ø –ó–ê–í–ï–†–®–ï–ù–ê —Å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è–º–∏. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ—Ç—á–µ—Ç."
else
    log "‚ùå –û–ë–ù–ê–†–£–ñ–ï–ù–´ –ü–†–û–ë–õ–ï–ú–´. –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –æ—à–∏–±–∫–∏."
    exit 1
fi

# –ü–æ–∫–∞–∑–∞—Ç—å –ø—É—Ç—å –∫ —Å–∫—Ä–∏–ø—Ç–∞–º –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
log ""
log "–î–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:"
log "  ./migration-s3/add-new-photos.sh /path/to/new/photos"
log ""
log "–î–ª—è –æ—Ç–∫–∞—Ç–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ):"
log "  ./migration-temp/rollback-content.sh"